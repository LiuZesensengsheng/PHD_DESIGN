# 战役系统UI设计：DDL侵占系统 (Campaign UI: The Deadline Invasion System)

## 1. 核心概念：可交互的焦虑可视化

本设计的核心，是摒弃传统的静态地图，创造一个**动态的、能主动"侵占"玩家选择空间的"活"界面**。我们称之为 **"DDL侵占系统"**。

它的唯一目的，是将博士生面对截止日期时那种"**生活被科研彻底吞噬**"的真实焦虑与压迫感，转化为玩家能直观看到、感受到、甚至被其剥夺选择权的物理游戏机制。

**设计哲学：大难临头，你无处可逃。**

---

## 2. 系统架构：分层轨道与动态侵占

战役地图由多个**平行的、分层的横向轨道**构成，代表着博士生涯的不同方面。

- **轨道分层 (Layered Tracks)**:
    - **顶层 - 科研主线 (Research Track)**: 优先级最高。所有核心战斗（组会、答辩）和关键DDL都位于此轨道。
    - **底层 - 日常轨道 (Routine Tracks)**: 优先级较低。包括`个人生活`（休息处）、`日常事务`（商店、日常事件）等。

- **"侵占"机制 (The Invasion Mechanic)**:
    1.  **和平时期**: 在DDL遥远时，顶层的"科研主线"轨道是**半透明的**或只占标准宽度。玩家可以清晰地看到并点击下方的所有日常节点。
    2.  **危机逼近**: 随着DDL临近，顶层轨道的背景**颜色开始变化（绿->黄->红）**，并且其**视觉高度开始向下扩张**，逐渐**部分遮挡**住下方的日常节点。
    3.  **彻底吞噬**: 当DDL进入最终冲刺阶段，顶层轨道会变为**完全不透明的、令人不安的深红色乃至红黑色**，并扩张到最大高度，将下方的日常轨道**完全覆盖**。

- **后果：选择权的剥夺**: 被完全覆盖的节点，将**彻底失去交互性**。这意味着，在毕业答辩的前夕，玩家将物理上**无法选择"摸鱼"或"休息"**。


## 3. 游戏流程与核心动机

游戏通过在地图上选择节点来推进，总流程约为20-30次选择。玩家的核心策略，是在顶层轨道彻底"侵占"生活之前，尽可能地从底层轨道获取资源，为DDL做准备。

### 3.1. "课题进度"系统 (Project Progress System)
本系统是连接玩家日常行动与关键战斗的核心机制。玩家在地图上的行动，其核心收益是为下一个DDL节点填充一个可视化的**"准备进度条"**。当玩家到达该DDL节点时，进度完成度将直接转化为影响整场战斗的初始Buff或Debuff。

- **准备等级与效果**:
    - **准备充分 (进度 90% - 100%)**:
        - **Buff: `有备而来`**。效果: 战斗开始时，获得15点`自信`，额外抽2张牌，且敌人的首次攻击伤害减半。
    - **准备合格 (进度 50% - 89%)**:
        - **Buff: `中规中矩`**。效果: 战斗开始时，获得5点`自信`。
    - **准备不足 (进度 10% - 49%)**:
        - **Debuff: `勉强应付`**。效果: 战斗开始时，你的初始`压力`+10，并在牌库中塞入1张`自我怀疑`（诅咒卡）。
    - **完全没准备 (进度 < 10%)**:
        - **Debuff: `临阵磨枪`**。效果: 战斗开始时，你的初始`压力`+20，塞入2张`自我怀疑`，且敌人开场即获得`不耐烦`状态。

### 3.2. "战役天赋"系统 (Campaign Talent System)
一个与**战斗天赋**完全解耦的、专注于**宏观战略与资源管理**的成长体系。这些天赋只影响玩家在"DDL侵占地图"上的行为，例如：

- **天赋示例**:
    - **`精力充沛`**: 增加你在两次DDL之间可选择的节点总数。
    - **`高效工作`**: 科研相关的节点，能为你提供更多的"准备进度"。
    - **`卓越的项目管理者`**: 如果你远在DDL轨道"侵占"发生前就完成了准备，会获得额外的`灵感点数`奖励。
    - **`社交达人`**: 提升"休息处"节点的效果。

---

## 4. 日常事件示例

`日常事件 (?)`节点会触发一段生活化的、无选择的遭遇，直接给予玩家一个效果。以下是一些事件示例：

### 分类：网上冲浪
- **事件**: 你打开知乎，在一个"博士第四年还没发文章是种怎样的体验？"的问题下，匿名写下了洋洋洒洒三千字的回答，收获了2个赞。
- **效果**: 下次战斗开始获得10点`自信`。
- **事件**: 你发现了一个在线"p-value > 0.05"表情包生成器，并制作了十几个。
- **效果**: 最大`压力`值上限 + 2。

### 分类：胡思乱想
- **事件**: 你花了一个小时构思一篇以你的导师为反派的奇幻小说。
- **效果**: 获得20`灵感点数`。
- **事件**: 你在脑海中复盘了半年前与审稿人的那场争论，这一次，你想出了一套完美的反驳。
- **效果**: 下次战斗开始时，将一张`反驳`（0费，造成5点说服力，抽1张牌）置入手牌。

### 分类：游荡闲逛
- **事件**: 你在校园里闲逛，遇到一只猫，并和它对视了十分钟。你觉得它比你实验室的一些同事更能理解你。
- **效果**: `压力`值降低10点。
- **事件**: 你路过隔壁实验室，听到里面传来欢声笑语。他们似乎又发了一篇顶刊。
- **效果**: 下次战斗初始`压力`+3，并在你的抽牌堆里塞入一张`嫉妒`（诅咒卡）。
- **事件**: 你假装去打印论文，实际上是去闻打印机散发出的温暖的墨粉味，这让你感到一丝慰藉。
- **效果**: 在商店中，下一次"移除卡牌"服务的费用降低50%。

这个"DDL侵占系统"的设计，将成为我们游戏区别于所有同类产品的、最闪亮的创新核心。


## 5. 附录：系统实现策略与技术选型

本附录旨在为系统的实现提供清晰的策略指导。

### 5.1. 设计目标："焦头烂额"的博士生体验

我们期望达成的核心体验是让玩家感受到"焦头烂额"：永远在用一个DDL去对抗另一个DDL，在多重危机中挣扎，胜利的喜悦总是短暂的，因为一个问题的解决往往孕育着另一个更大的危机。

为达成此目标，我们设计了以下机制：

1.  **危机来源 - 导师的"灵光一闪"**: 游戏进程中会**动态生成**临时的、紧急的DDL轨道，打乱玩家的规划。
2.  **危机放大器 - "并发症"系统**: 一条轨道的"忽视度"过高，会**触发对其他轨道的负面影响**，形成"按下葫芦浮起瓢"的困境。
3.  **危机后果 - "机会成本的诅咒"**: 完成一个DDL后，系统会明确提示玩家"为此付出了什么代价"（例如，其他轨道的"忽视度"因此大幅上升）。

### 5.2. 开发策略：领域驱动设计 (DDD)

- **核心思想**: **"模型先行，分层构建"**。我们将采用领域驱动设计（DDD）原则，优先构建稳定、清晰的领域模型，确保核心逻辑的内聚与表达力。
- **具体做法**:
    - **领域建模 (Domain Modeling)**: 我们将首先定义战役地图的核心领域对象，如 `CampaignMap`, `Track`, `Node`, `Deadline` 等，以及它们之间的关系和不变量。
    - **分层架构 (Layered Architecture)**: 代码将遵循清晰的分层结构（如 `Domain`, `Application`, `Infrastructure`, `Presentation/UI`），确保各层职责单一，易于测试和维护。
    - **数据驱动**: 系统的行为将由数据驱动，而非硬编码逻辑。例如，`DDL轨道` 的生成、`并发症` 的触发等，都将基于可配置的数据和规则，而非写死的 `if...else`。
- **技术债管理**: 我们将从一开始就关注代码质量，避免产生不必要的技术债。这虽然在初期需要更多的思考和设计，但将为项目长期的健康和可扩展性奠定坚实的基础。
- **给开发者的指引**: 请遵循DDD原则进行开发。优先思考领域模型，确保业务逻辑在领域层得到清晰的表达。利用分层架构解耦不同层面的问题。

### 5.3. MVP阶段设计原则：关于DDL完成机制

经过讨论, 我们为MVP版本确立以下设计原则：

- **DDL无法被"提早"完成**: 一旦DDL轨道生成，其长度（包含的节点数）是固定的。玩家必须走完所有规划的节点，到达并完成最终的"结算节点"，才能完成该DDL。不允许通过任何机制（如特殊卡牌或事件）"跳过"或"直接完成"整个轨道。

- **设计哲学 ("博士生的宿命")**: 这一决策旨在强化游戏的核心体验——"熬"。它强调了博士生涯中面对长期项目时，那种"路漫漫其修远兮"的挣扎感和宿命感，迫使玩家将策略重心放在"多线任务的平衡"而非"单线任务的加速"上。

- **未来的可能性 ("天才的捷径")**: 允许"提早完成"DDL的功能，被视为一个激动人心的**未来扩展方向**。在游戏的正式版或后续更新中，可以考虑引入特定角色、传说卡牌或稀有事件，来实现这种"天才"玩法，作为对核心规则的一种高回报、高风险的突破。

---

## 6. 附录二：当前项目进度

为了更好地协调后续开发，此处简要记录项目当前已完成和待办的事项。

*   **核心系统与UI**:
    *   **战斗界面**: 核心UI框架已基本完成，可进入逻辑开发阶段。
    *   **DDL侵占系统**: 核心概念与设计稿已完成。

*   **内容设计**:
    *   **卡牌设计**: 已完成约10张核心卡牌的初步设计。
    *   **"日常事件"系统**:
        *   系统框架已确定。
        *   事件文本内容已完成约50% (由朋友贡献了约20条"梗")。
        *   (参考: `docs/DRAFT_EVENTS_MEME.md`)

*   **当前瓶颈与下一步计划**:
    *   **战斗逻辑**: 战斗系统的核心逻辑（如卡牌效果结算、状态处理等）是当前最高优先级的开发任务。
    *   **敌人设计**: 亟需设计具体的敌人（如`审稿人`、`答辩委员会`），包括他们的独特技能、血量、攻击模式等，以便于战斗逻辑的实现与测试。