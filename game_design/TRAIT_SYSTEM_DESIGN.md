# 特质系统设计 (Trait System Design)

## 设计理念

基于用户最终决策：**只用特质，不用属性点，特质替代遗物，卡牌设计完全创新**

### 核心原则
1. **特质替代遗物** - 保持杀戮尖塔的遗物收集机制，但内容完全重新设计
2. **卡牌创新** - 战斗机制相同，但卡牌效果和主题完全原创
3. **学术主题** - 所有特质和卡牌都围绕博士生活展开

## 特质系统架构

### 特质分类 (Trait Categories)

#### 1. 学术特质 (Academic Traits)
- **研究狂热** - 每回合开始时，如果手牌中有研究类卡牌，获得1点能量
- **论文焦虑** - 每当你打出攻击卡牌时，有25%几率获得1点护甲
- **导师光环** - 战斗开始时，获得2点护甲和1点能量
- **实验室老鼠** - 每回合结束时，如果本回合使用了3张或更多卡牌，获得1点能量

#### 2. 生活特质 (Lifestyle Traits)
- **咖啡成瘾** - 每当你失去生命值时，获得1点能量
- **熬夜达人** - 战斗开始时，你的手牌上限+1
- **社交恐惧** - 每当你受到攻击时，有30%几率只受到一半伤害
- **完美主义** - 每当你打出稀有卡牌时，获得1点护甲

#### 3. 心理特质 (Psychological Traits)
- **压力山大** - 每当你受到攻击时，有20%几率获得1点能量
- **自我怀疑** - 每回合开始时，如果你有负面状态，获得1点护甲
- **学术自信** - 每当你打出攻击卡牌时，如果目标敌人有护甲，额外造成2点伤害
- **研究直觉** - 每当你抽到研究类卡牌时，将其费用-1

### 特质获取机制

#### 获取方式
1. **战斗奖励** - 击败精英敌人后选择特质
2. **事件奖励** - 特定事件提供特质选择
3. **商店购买** - 使用金币购买特质
4. **成就解锁** - 完成特定挑战解锁特质

#### 特质稀有度
- **普通特质** (Common) - 基础效果，容易获得
- **稀有特质** (Rare) - 强力效果，需要特定条件
- **史诗特质** (Epic) - 改变游戏机制，非常稀有
- **传说特质** (Legendary) - 极其强力，可能影响整个游戏

## 特质与卡牌协同

### 特质-卡牌组合示例

#### 研究流 (Research Build)
- **特质**: 研究狂热 + 研究直觉
- **核心卡牌**: 文献综述、实验设计、数据分析
- **协同效果**: 研究卡牌费用降低，每回合稳定获得能量

#### 压力流 (Stress Build)
- **特质**: 压力山大 + 自我怀疑
- **核心卡牌**: 焦虑爆发、压力释放、心理调节
- **协同效果**: 通过承受伤害获得能量，用护甲保护自己

#### 社交流 (Social Build)
- **特质**: 社交恐惧 + 导师光环
- **核心卡牌**: 学术演讲、同行评议、学术会议
- **协同效果**: 高防御力，通过社交类卡牌获得优势

## 实现优先级

### Phase 1: 基础特质系统
1. 实现特质数据结构
2. 创建特质管理器
3. 实现特质效果系统
4. 基础特质获取机制

### Phase 2: 特质-卡牌协同
1. 设计特质触发的卡牌效果
2. 实现特质组合效果
3. 平衡特质强度

### Phase 3: 高级特质
1. 史诗和传说特质
2. 特质升级系统
3. 特质解锁成就

## 技术实现

### 特质数据结构
```python
@dataclass
class Trait:
    id: str
    name: str
    description: str
    rarity: TraitRarity
    category: TraitCategory
    effects: List[TraitEffect]
    unlock_condition: Optional[UnlockCondition]
```

### 特质效果系统
```python
class TraitEffect(Protocol):
    def apply(self, game_state: GameState) -> None:
        """应用特质效果"""
        pass
    
    def can_trigger(self, trigger_event: GameEvent) -> bool:
        """检查是否可以触发"""
        pass
```

## 平衡考虑

### 特质强度控制
1. **效果限制** - 每个特质最多影响1-2个游戏机制
2. **触发条件** - 特质需要特定条件才能触发
3. **负面效果** - 强力特质可能带有负面效果
4. **组合限制** - 某些特质组合可能被禁止

### 获取平衡
1. **稀有度分布** - 普通:稀有:史诗:传说 = 60:25:12:3
2. **获取难度** - 史诗和传说特质需要特定成就
3. **随机性** - 特质获取有一定随机性，增加重玩价值

## 测试计划

### 单元测试
1. 特质效果正确性
2. 特质触发条件
3. 特质组合效果

### 集成测试
1. 特质与卡牌系统集成
2. 特质与战斗系统集成
3. 特质获取机制

### 平衡测试
1. 特质强度评估
2. 特质组合平衡性
3. 游戏难度曲线

## 下一步行动

1. **创建特质数据文件** - 定义所有特质的基础数据
2. **实现特质管理器** - 处理特质的获取、应用和触发
3. **设计特质效果** - 实现各种特质的具体效果
4. **集成到战斗系统** - 将特质系统集成到现有战斗流程中 