## 设计文档：理想崩坏与发疯系统 v1.0（SAN 轨迹草案）

**文档状态**: `v1.0 - 概念草案（下一期工作，占位，不要求立刻实现）`  
**关联法典**:  
- 战斗系统总览：`docs/design/COMBAT_SYSTEM_DOCUMENT.md`  
- 理想系统法典：`docs/design/IDEAL_SYSTEM_DESIGN_v8.0_FINAL.md`  

---

## 0. 目的与总则

- **目标**: 在**不新增新的资源条**（不再加一条独立 SAN 条）的前提下，把现有的「压力=100 → 理想审判 → 裂痕/破灭 → Excel 地狱」  
  升级为一个 **可感知的“发疯曲线”**：玩家真正体验到“博士是怎么一点点变得不正常”的过程。
- **核心思想**:  
  - **理想 = SAN**：理想蜡烛与其裂痕/破灭状态，本质上就是我们的 SAN 条。  
  - **压力 = 触发条件**：压力 100 只是触发“理想检定（SAN Check）”的闹钟。  
  - **心魔 = 认知失调的沉淀物**：数量/类型记录了你背叛理想的方式。  
- **约束**:  
  - 不推翻 `COMBAT_SYSTEM_DOCUMENT` 与 `IDEAL_SYSTEM_DESIGN_v8.0_FINAL` 的核心机制；  
  - 仅在现有「审判 / 心魔 / Excel 地狱」基础上，**叠加“发疯表现层”**（行为、文案、小状态），作为下一期扩展。

---

## 1. 博士发疯轨迹（Sanity Track）——状态图

本节把现有的理想状态（完整 / 裂痕 / 破灭 / 全灭+Excel）映射成一条**“博士发疯轨迹”**。  
不新增资源，只是给现有状态一个更加叙事化、便于后续演出的分段。

> 备注：以下阶段名称为**叙事用语**，可在事件、对白、成就中引用；  
> 数值上只依赖现有的 `crack_stacks / lifetime_count / 已破灭理想数 / 是否 Excel 地狱`。

### 阶段 0：入学前的人类（Healthy Idealist）

- **数值条件**：  
  - 所有理想均无裂痕（`crack_stacks=0`），`lifetime_count` 总体较低；  
  - 没有理想被破灭（shatter）。
- **叙事画像**：  
  - 相信“科研是有意义的”、“辛苦会有回报”；  
  - 会抱怨，但抱怨是出于“希望变得更好”。  
- **表现建议（未来可选实现）**：  
  - 卡牌、事件文案偏乐观/认真；  
  - UI 为「魔法手稿阶段」的最明亮版本。

### 阶段 1：高功能疯子（High-Functioning Madness）

- **数值条件（示例建议）**：  
  - 任意理想出现 1 次裂痕（`crack_stacks>=1`），但**尚无理想破灭**；  
  - 或 `lifetime_count` 累积到中等阈值（例如 ≥5）。
- **叙事画像**：  
  - 白天疯狂卷、晚上靠自嘲止血；  
  - 行为效率很高，但自我对话开始出现“我知道这样不对，但先撑过这次”的句子。  
- **表现建议**：  
  - 事件选项中开始出现“自嘲式合理化”的回答；  
  - 部分理想相关卡牌的台词变成更辛辣/自黑的版本。

### 阶段 2：信仰扭曲者（Corrupted Believer）

- **数值条件**：  
  - 至少有 **1 个理想已破灭（Shatter）**；  
  - 或某个理想 `crack_stacks>=2` 并多次被判为裂痕。
- **叙事画像**：  
  - 口头上仍然引用当初的理想语言，但语气已经反过来用：  
    - “科研的意义？当然是为了 KPI 和不被淘汰。”  
  - 会主动选择对他人施压、对自己撒谎的选项，并且觉得“这很正常”。  
- **表现建议**：  
  - 某些“理想主义卡牌”的文案，替换为**更黑暗的版本**，效果数值不一定变强，但语气彻底变味；  
  - 敌人事件会更频繁提供“黑色/红色”的诱惑选项。

### 阶段 3：Excel 化人形（Excelified Entity）

- **数值条件**：  
  - 所有理想均已消失/崩塌 → 进入 Excel 地狱（参见现有设计）；  
  - 下一次压力=100 → 燃尽，游戏结束。
- **叙事画像**：  
  - 不再主动思考“意义”，将自己视为系统中的一行。  
  - 情绪仍会出现，但更多是“任务失败的懊恼”，而非世界观层面的痛。  
- **表现建议**：  
  - UI 切换为 Excel；  
  - 自己的台词、事件文案中大量出现数字、公式、项目管理语言；  
  - 某些幻想系卡牌失效或效果被“工具化重写”（已在战斗文档中定义）。

---

## 2. 理想审判 = SAN 检定（Judgment as SAN Check）

现有规则（摘自 `IDEAL_SYSTEM_DESIGN_v8.0_FINAL.md`）：

- 压力达到 100 → 触发**针对某个理想**的“坚定检定 (Conviction)”；  
- 基于 `window_count`（近期心魔）+ `lifetime_count`（历史心魔）计算 `effective`；  
- 映射到三种结果：**美德 / 裂痕 / 破灭**。

本节只在此基础上增加一层 **“短期发疯 Episode”**：  
> 每次审判结果，不仅改变数值，还暂时改变你的行为方式。

### 2.1 美德结果：过度理智的圣徒（Virtue Episode）

- **触发条件**：`effective=0` → 判为【美德】。  
- **短期效果（候选模版，未来可从中选 1–2 实装）**：
  1. 【过度自控】本战剩余时间内，你**不能打出任何 `[捷径/妥协]` 标签的牌**；若强行打出，则额外+1 张对应心魔。  
  2. 【冷静过头】接下来 X 回合，你无法获得“怒气式爆发”类 buff（例如额外能量/额外抽牌）；  
     取而代之的是“小而稳定”的收益（例如+1 自信）。  
- **叙事语气**：  
  - “你强迫自己保持清醒，好像在从第三人称视角观察自己。”  
  - 玩家会感觉：**做对了选择，但这份正确本身也有点不正常。**

### 2.2 裂痕结果：高功能自毁（Crack Episode）

- **触发条件**：`effective=1–2` → 判为【裂痕】且选择“承受”（不是当场牺牲）。  
- **短期效果（候选模版）**：
  1. 【把今天打完】本回合结束时，若你手牌数量 ≥2，则额外获得 1 张该理想颜色的心魔。  
     - 含义：你强迫自己“把今天的牌打干净”，否则就会因为“没做够”而内耗。  
  2. 【偏执追求】接下来 X 回合内，你**每回合必须至少打出 1 张该理想颜色的牌**，否则压力+5。  
     - 含义：你一边怀疑这个理想，一边又更拼命地去做与它相关的事。
- **叙事语气**：  
  - “你知道自己在受伤，但你选择用更狠的方式继续执行这套信仰。”

### 2.3 破灭结果：人格重构（Shatter Episode）

- **触发条件**：`effective≥3` 或 `crack_stacks≥2` 或 `window_count≥3` → 判为【破灭】。  
- **短期/中期效果（候选模版）**：
  1. 【理论重写】本战剩余时间内，每当你获得一张新牌（奖励/生成），随机弃置 1 张旧牌。  
     - 含义：你在疯狂重构自己的人格/理论体系，用新东西把旧自我一块块拆掉。  
  2. 【角色互换】接下来 X 回合内，你的某些“自保型/防御型”牌会随机转化为“攻击/施压型”牌。  
     - 含义：你从“保护自己”转向“把同样的恶施加给别人”。
- **叙事语气**：  
  - “那一刻，你意识到：你已经不是当初那个来读博的人了。”

> 实现建议：  
> - 这些 Episode 可以作为 `JudgmentService` 结算结果后的**可选挂钩**，先以 1–2 个简单状态（比如“本回合限打干净手牌”）实验；  
> - 复杂行为（如牌面转换）可以留到更后期。

---

## 3. 心魔症状表（Heart Demon Symptoms）

现有设计中，心魔已经定义为：  
- 战斗限定的诅咒牌；  
- 回合结束若在手牌中：承受压力 + 施加下一回合特定的负面效果。

本节在此基础上增加一个**低频触发的“症状层”**：  
> 当心魔在一场战斗中累计达到某些节点时，触发一次“精神症状 Episode”，  
> 使玩家在短时间内做出**又好笑又危险**的异常行为。

### 3.1 触发规则（建议）

- 定义：  
  - `heart_demon_resolved_count`：本战中，已经结算过的心魔张数（回合结束时在手牌中触发效果算一次）。  
- 触发节点（占位）：  
  - 第 3 张、第 6 张心魔结算时，各触发一次“症状 Episode”。  
  - 每场战斗最多触发 2 次症状。

### 3.2 症状 Episode 示例（候选池）

- 【深夜复盘】  
  - 效果：本回合结束时，**自动免费重播你本回合最后打出的 1 张技能牌**（再次结算效果），然后额外+5 压力。  
  - 含义：你控制不住地在脑中“复盘刚才那招”，一遍又一遍。

- 【强迫道歉】  
  - 效果：本回合内，你**不能对敌人造成致命一击**；如果伤害本应击杀，强制将其生命留在 1 点。  
  - 叙事：  
    - “你下不去手结束这件事，总是在替对方找理由：‘也不全是 TA 的错’。”

- 【论文人格化】  
  - 效果：本回合开始时，随机 1 张手牌被标记为“本回合主角”；  
    - 如果回合结束时你**没有打出这张牌**，则压力+8。  
  - 含义：你开始把某篇论文或某个项目当成“有生命的东西”，非要给它一个交代。

- 【安全区解离】  
  - 效果：本回合内，你的所有“防御/自信相关牌”费用+1，但伤害牌费用-1。  
  - 含义：你暂时放弃自我保护，把一切资源倾向于“攻击/对抗”。

> 说明：  
> - 这些症状不必一次性全部实装，可以先挑 1–2 个做原型；  
> - 数值强度可以很轻（偏演出），重要的是**让玩家意识到：心魔多了，会影响“你是一个怎样打牌的人”。**

---

## 4. 与现有系统的对齐与边界

### 4.1 与 `COMBAT_SYSTEM_DOCUMENT` 的关系

- 保留原有规则：  
  - 压力 100 → 触发“初心的考验 / 审判”；  
  - 压力 200 → 学术休克，战斗失败；  
  - 全部理想熄灭 → Excel 地狱 → 下次压力 100 = 燃尽。
- 本文档仅在以下点上**增加“疯味”层**：  
  - 为审判结果附加短期 Episode；  
  - 为心魔累计增加症状 Episode；  
  - 为不同“理想崩坏阶段”定义人格分段，用于 UI/文案/事件演出。

### 4.2 与 `IDEAL_SYSTEM_DESIGN_v8.0_FINAL` 的关系

- 不改动四大支柱的底层逻辑（坚守 / 妥协 / 审判 / 牺牲）。  
- **补充视角**：  
  - 将第三支柱【审判】明确视为 **SAN 检定**；  
  - 将第四支柱【牺牲】视为一种**主动触发的“自我切除手术”**，可在未来 Episode 中给予更多发疯演出（例如“切掉理想换来冷静到可怕的效率”）。

---

## 5. 后续工作建议（下一期 TODO 草案）

> 本节仅为未来版本提供「可以做什么」的清单，当前版本无需实现。

- **文案层**  
  - 为发疯轨迹四阶段各写一页“典型一天”的短文（用于成就/结局/开场旁白）。  
  - 为美德/裂痕/破灭的 Episode 写 3–5 条简短文案。

- **系统层（轻量实现优先）**  
  1. 在 `JudgmentService` 结算后，增加一个简单 Episode 钩子：  
     - v1 版本可以仅实现【裂痕 → 本回合若手牌≥2则额外 1 张心魔】。  
  2. 在心魔服务中记录 `heart_demon_resolved_count`，  
     - v1 版本实现一个简单症状：第 3 张心魔结算时，本回合结束额外+5 压力。

- **演出层（可远期）**  
  - 根据发疯阶段，调整甘特图/战斗 UI 的细微元素（颜色、噪点、文字风格）；  
  - 在 Excel 地狱阶段，为部分卡牌替换为“工具人语言版”卡面。

---

> 一句话总结：  
> 这份文档的目的，是在**不增加额外资源条**的前提下，  
> 把你已经有的「理想+压力+心魔+Excel 地狱」升级为一条 **有段落、有症状、有故事的发疯曲线**，  
> 让玩家真正体验到：  
> **“读博不是突然死，而是一步一步不正常。”**


