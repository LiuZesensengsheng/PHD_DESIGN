## 白色 · 指针排序主题 v3（核心：Pointer Sorting，保留少量整体排序）

### 目标与范围
- 将“指针排序”确立为白色的核心表达：少移敌、多移指针/改扫描规则，降低操作与视觉负担。
- 保留少量“整体排序/分区/洗牌”等重控元素，作为爆发或应急工具（多【消耗】/限次）。
- 与 v2 的“范式/坚定/规整/端点/序列”无缝衔接。

---

### 1. 指针引擎（系统定义）
- 指针状态：`idx`（0..n-1）、`dir`（left|right，遇边折返）、`per_turn_limit`（默认5）。
- 触发窗口：
  - `on_play_card`：每当你打出一张牌，对 `idx` 指向敌人造成 `PD` 基础伤害，然后按 `dir` 移动 1 格（到头折返）；每回合最多触发 `per_turn_limit` 次。
  - 可选：`on_turn_start/end` 触发一次小额伤害/规整（用于数值微调）。
- 数值建议：`PD=2(升级3)`；`per_turn_limit=5(升级6)`；对应每回合额外 10–15 伤害的成长空间。
- UI/可读性：明确高亮指针格与方向箭头；当“视图序结算”时弹出提示。

#### 术语口径（卡面用语）
- “指针下的单位”：指当前 `idx` 所指的敌人（统一文案，替代“扫描位/焦点”）。
- “遍历触发”：指 `on_play_card` 的 PD 小段伤害与随后的指针步进（受 `per_turn_limit` 限制）。

#### 指针伤害的“随牌附加”模型（累积爽点）
- 基线：`on_play_card` 触发 1 次指针小段伤害（PD），即“你每打出一张牌：先结算牌面目标，再对指针目标造成 PD”。
- 每回合触发上限：沿用 `per_turn_limit`（默认5，升级6）。
- 可选拓展（少量牌使用）：
  - 邻位扩散：`pointer_next_by_dir`（对指针下一格命中）。
  - 链式触发：`pointer_chain(count=2–3)`（逐段触发，须叠总上限）。
  - 临时增益：`pointer_pd_add(+1，本回合)`、`pointer_limit_add(+1，本回合)`。
- 动画：多段聚合显示（计数浮字），降低噪音。

#### 指针自动引导（Bootstrap）
- 指针为白色独有，单例（每场战斗至多 1 个）。
- 任何带 `Pointer` 关键词的白色卡牌在结算开始时，若你尚未建立指针：建立指针（位置=最左，`PD=2`，`per_turn_limit=5`，方向=向右），然后继续执行该牌效果。
- 若已存在指针，则不重复建立。

标准卡面前缀（统一文案模板）：
- “若未建立指针：建立指针（最左，PD=2，上限=5）。然后：[…]”

---

### 2. 机制与关键词
- `Sorting`（算法）/ `Pointer`（指针）/ `Pivot`（枢轴）/ `Middle`（中位）/ `Partition`（分区）/ `ViewOrder`（视图序，不改视觉位置）。
- `Combo(Sorting)`：本回合已打出带 `Sorting` 的牌 → 指针 `PD+1`（或下一张“遍历/端点”+2）本回合生效；上限 +3。
- `LockQueue`（锁序）：本回合禁止位移（reposition 失效），但顺序结算照常进行。
  - 约束标签：`requires.pointer_at_endpoint`（仅当指针位于端点时可用）。

#### 2.1 白色能量（理想）规则
- 回合开始：获得 1 点“白色能量”（white_energy）；不可累积，回合结束清空。
- 可支付范围：仅用于“白色且带 Sorting/Pointer 的 Skill”。
- 下限：不可将费用降至 1 以下（floor=1）；0 费牌不消耗白色能量。
- 排除：不作用于 Attack、重控/爆发类牌；`pointer_warp` 等 0 费功能牌默认不消耗白色能量。
- 落地建议：卡牌侧标注 `eligible_for_white_energy=true`；结算侧优先消耗 `white_energy`，余量再消耗常规能量。

---

### 3. 卡牌分层与配比（指针为主）
- 非位移顺序牌（约 50%）：端点、遍历、中位、第k位、标签优先、指针爆发。
- 轻控（约 30%）：冒泡（相邻交换）、插入中位、指针旋转/跃迁/加速。
- 重控（约 20%）：快速排序/分区/洗牌（多【消耗】或回合限1）。

---

### 4. 基础卡（建议首批最小可玩包）
1) 继承（Skill，1）：选“指针下的单位”，与指针一起向左移动 1 格；若已在最左则不移动（仍计入位移上限）；造成 4 点伤害。
2) 批判（Skill，1）：选“指针下的单位”，与指针一起向右移动 1 格；若已在最右则不移动（仍计入位移上限）；造成 4 点伤害。
3) 插入（Skill，1）：当指针在端点下才能使用（置灰不退款）；将“指针下的单位”向内移动 1 格（`requires.unit_is_endpoint`）；造成 4 点伤害。

4) 审批（Skill，1）：选中一个内部单位；将其移动到最近或指定端点（重控；每回合至多 1 次或【消耗】）；不造成伤害。

5) 顾头（Skill，0）：`pointer_warp(to=left_endpoint)`；不触发路径伤害；不占用 `per_turn_limit`；每回合至多使用 1 次。
6) 顾尾（Skill，0）：`pointer_warp(to=right_endpoint)`；不触发路径伤害；不占用 `per_turn_limit`；每回合至多使用 1 次。

可选补充（不进入最小包，供后续扩展/稀有）：
- 遍历（Skill）：将指针以步进方式移动到端点；路过每个单位各造成固定伤害，端点额外伤害（见第6节“路径伤害”与第10节数据口径）。
- 游走：随机移动指针，并对其前后各 1 个单位造成伤害（随机性高，阅读成本↑）。
- 链表：将“指针下的单位”和随机单位调换位置（不稳定节奏器）。
- 并行：对“指针周围”的单位造成范围伤害（与【规整】联动良好）。

Buff 卡（建议 2 张）：
- 集中（Skill，1）：对“指针下的单位”施加【破防】2 回合。
- 解析（Skill，1）：对“指针下的单位”施加【规整】+2（仅本回合）。


防御卡（建议 2–3 张，必需）：
- 深呼吸（Skill，1）：获得 5 点自信。
- 校正（Skill，2）：获得 9 点自信，并获得 1 层【坚定】。
- 队列冻结（Skill，1）：本回合 `LockQueue` 生效；二选一：获得 6 点自信，或本回合 `per_turn_limit +1`。

引擎卡（Power，建议 1–2 张）：
- 结算（Power，1）：当有单位被你移动到端点→对其造成 3 点伤害，或施加【规整】+1（二选一）；每回合至多触发 2 次。
- 统计（Power，1）：当你移动单位→每第 2 次触发抽 1；每回合至多触发 2 次。
- 焦点（Power，1，稀有）：当“指针下的单位”被你移动→本回合 `PD+1`；每回合至多触发 1 次。

---

### 5. 保留的整体排序元素（精简版）
- 快速排序（【消耗】）：选 `Pivot` → 小于Pivot移左，其余移右；每被搬动的敌人【规整】+1；本回合“遍历/端点”每命中一侧 +1 伤。
- 旋转1（轻控）：全体循环右移 1；旋转后“左端点”本回合每段 +1。
- 反转（轻控）：队列反转；本回合“遍历”改从右往左并 +2 基础伤。
- 洗牌（【消耗】）：随机重排；补偿 3(4) AOE 或全体【规整】+1（二选一）。

---

### 6. 数值与护栏
- 指针：`PD=2/3`，`limit=5/6`；动画低频，反馈清晰。
- 位移上限：每回合位移 ≤ 2–3；超限的位移牌转为 `ViewOrder` 结算。
- 重控权重：≤ 20%，并多【消耗】或“每回合至多 1 次”。
- 0费护栏：标注 `PerTurnLimit`（如指针旋转 0 费形态每回合至多 1 次）。
 - 能量经济：白色能量 1/回合（不可累积）；仅支付白色 Sorting/Pointer 的 Skill；floor=1；排除 Attack/重控。

#### 端点条件与路径伤害（严谨输出）
- `requires.pointer_at_endpoint` 的卡（如“端点插入”）在指针不在端点时不可使用（按钮置灰，给出条件提示，不退款，不退费）。
- “路径伤害”定义：指令驱动的逐步移动过程中，对每个被路过的单位各结算一次伤害；不占用 `per_turn_limit`；默认不触发“on_play_card”连段。
- 数值建议：路径伤害 2–4，端点额外伤害 1–3；与【规整/破防】有乘法/加法放大空间。

---

### 7. 与状态/资源的协同
- 破防：小段伤害 ×1.5 拉高 `PD` 的边际价值；与“端点/爆发”卡组合易达 20 伤/能量。
- 规整：多段触发，“指针爆发/扫描线”收益显著。
- 严谨：卡牌逐段 +R，和 `PD` 叠加友好。
- 坚定：通过“完美格挡→抽/返能”维持连打节奏，拉高指针触发次数的收益。

#### 防御互动（可选强化）
- 完美格挡后（坚定触发）：本回合 `pointer_pd +1` 或“立刻额外触发一次指针”。
- 锁序防守：当回合 `LockQueue` 生效时，你的防御牌基础值 +2，或指针 `per_turn_limit +1`（二选一设定）。

---

### 8. UI/动效与可读性
- 指针格高亮、方向箭头、触发计数器（0/5 → 1/5 ...）。
- `ViewOrder` 播放时显示“按逻辑顺序结算（不改站位）”。
- `LockQueue` 播放时显示“队列已锁定”。

---

### 9. 遥测与验收
- 指标：位移次数/回合、指针触发次数/回合、回合时长、20+/能量回合占比、视图序误解率。
- 验收门槛：位移≤3/回合；平均回合时长≤45s；视图序误解反馈<10%；玩家能稳定攒出“指针爆发”型回合。

---

### 10. 附：数据落地口径（片段）
- 指针扫描（Power）
```
{ type: "pointer_engine", pd: 2, per_turn_limit: 5 }
{ hook: "on_play_card", effects: [ { type:"damage", value_from:"pointer_pd", target:"pointer_target" }, { type:"pointer_step", value:1 } ] }
```
- 视图序结算：`{ type:"sequence_damage", base:X, step:Y, target:"left_to_right", view_only:true }`
- 锁序：`{ type:"lock_queue", duration:1 }`
- 指针跃迁：`{ type:"pointer_warp", to:"lowest|middle" }`、`{ type:"pointer_pd_add", value:1, duration:"this_turn" }`

- 白色能量（理想）
```
{ hook: "on_turn_start",
  effects: [ { type:"gain_resource", resource:"white_energy", amount:1, expires_at:"turn_end" } ] }

// 卡牌侧：可用白色能量支付的资格标记
{ card_id: "...", eligible_for_white_energy: true, color:"white", tags:["Sorting","Skill"] }

// 支付策略：优先消耗白色能量
{ payment_policy: { use_white_energy_first: true, floor_cost: 1,
                   exclude_types:["Attack","HeavyControl","Burst"] } }
```

- 端点插入（仅端点可用）：
```
{ requires: { pointer_at_endpoint: true },
  effects: [ { type:"reposition", op:"move_to_middle", target:"pointer_target" },
             { type:"pointer_pd_add", value:1, duration:"this_turn" } ] }
```

- 端点冲刺（路径伤害，不占上限）：
```
{ type:"pointer_traverse_to_endpoint",
  to:"nearest",  // left | right | nearest
  on_pass: { type:"damage", base:3 },
  include_endpoint: true,
  endpoint_bonus: { type:"damage", base:2 },
  counts_against_limit: false }
```




---

### v4 实装卡组与规则对齐（当前可玩实现）

#### A. 全局规则（实现口径，对应本轮联动）
- 指针引擎（白色独有）：每当你打出一张牌，对“指针下的单位”造成 PD；本版本不自动步进，步进/跃迁由指针类牌控制
- 位移约束：仅允许“指针下的单位”发生位移；当尝试位移但未产生位置变化（端点贴墙、队列锁定、达上限等）时，触发“无移动双击PD”（两段独立 PD 伤害）。
- 队列冻结（LockQueue）：本回合禁止位移；并对所有敌人施加【规整】+1（仅本回合）。【规整】在每段伤害结算后追加等额纯伤。
- 击杀与收拢：敌人生命≤0即移除；其余敌人按 0.12s 补间收拢；指针索引按规则纠偏（保持“同实体/同槽位”语义）。
- 表达与可读性：伤害飘字按段顺序显示（例如 6 → 6 → 3）；指针缺省提示固定在最左，方向为右。

#### B. 白色 · 已实现卡牌（12 张）
（名称 | 类型 费用 | 核心定义）
- 遍历（指针引擎）| Power 2：建立/维持指针；你每打出一张牌，对指针下的单位造成 PD=3（每回合至多 6 次）。不自动步进。
- 继承 | Skill 1：对“指针下的单位”尝试向左移动一位；若未移动则对其结算两段 PD；并造成 6 点伤害。
- 批判 | Skill 1：对“指针下的单位”尝试向右移动一位；若未移动则对其结算两段 PD；并造成 6 点伤害。
- 插入 | Skill 1（端点限定）：当“指针下的单位”处于端点时，向内移动一位；造成 4 点伤害。
- 审批 | Skill 1：将“指针下的单位”移动至最近端点（重控）；不造成伤害。
- 顾头 | Skill 0：将指针跃迁到左端点。
- 顾尾 | Skill 0：将指针跃迁到右端点。
- 集中 | Skill 1：对“指针下的单位”施加【破防】2 回合。
- 解析 | Skill 1：对“指针下的单位”施加【规整】+2（仅本回合）。
- 深呼吸 | Skill 1：获得 5 点自信（防御）。
- 校正 | Skill 2：获得 9 点自信（防御）。
- 队列冻结 | Skill 1：本回合【LockQueue】生效；并对所有敌人施加【规整】+1（仅本回合）。

#### C. 关键联动范式（当前版本）
- “未移动 → 双击 PD”：在端点“再推”或被锁序阻止位移时，自动吃两段 PD；与【规整】叠加形成多段纯伤收益。
- “先施加再输出”：先用【解析】/【队列冻结】施加【规整】，再用位移/打击牌制造多段结算；
- “指针定向爆发”：通过【顾头/顾尾】把指针锚到端点，配合【继承/批判/审批】在端点位触发“未移动双击 PD”。

#### D. 进阶卡草案（无护栏版，方向化设计）
（只记录卡面核心定义，不含引擎护栏/回合上限等数值钩子）

- 左移·今天就要｜Attack 1
  - 将“指针下的单位”移动到最左；对其造成 距离×3 伤害。

- 右移·明天再说｜Skill 1
  - 将“指针下的单位”移动到最右；你获得 自信 距离×4。

- 专注·左｜Skill 1
  - 将指针从当前位置跃迁到左端；对经过的单位各施加【破防】1。

- 走神·右｜Skill 1
  - 将指针从当前位置跃迁到右端；对经过的单位各施加【虚弱】1。

- 计划通（位移触发）｜Power 2
  - 每当你使一个敌人改变位置：抽1。

- 运筹（自信触发）｜Power 1~2
  - 每当你获得自信：将“当前指针下的单位”向右移动1。

- 帷幄（位移加伤）｜Power 1~2 （移动流派）
  - 每当一个敌人被你移动：对其造成3点伤害（或：对其结算一次 PD）。

- 端点斩（端点处决）｜Attack 1
  - 若目标在左端：造成10点伤害；否则造成6点伤害。

- 压线打击（左移加成）｜Attack 1
  - 对“指针下的单位”造成6点伤害


- 终局裁决｜Attack 3
  - 对“指针下的单位”造成20点伤害。本回合每当你移动一个敌人：返还1点能量。

- 白纸黑字｜Attack 6
  - 造成26点伤害。本回合每当你移动一个敌人：本牌费用-1（可降至0以下；结算后弃置）。

- 一锤定音｜Attack 3（消耗）
  - 造成30点伤害。若场上仅剩1名敌人：本牌本次打出费用改为0。

- 结题报告｜Skill 2
  - 立即获得（本回合你已成功移动敌人的次数）×2 点自信；随后对“指针下的单位”造成（已成功移动次数）×2 点伤害。

- 专家会诊｜Skill 1
  - 本回合结束：按你本回合“成功移动次数”，每次依次触发（抽1 或 返1 或 对指针目标结算PD一次），从上到下轮流执行，直到次数用尽。

- 合规审判｜Skill 1
  - 对所有敌人和友放施加【规整】+2

- 规整归档｜Attack X
  - 消耗全部能量X。对所有敌人施加【规整】+X（仅本回合）；随后对“指针下的单位”结算PD X次。

##### 中段调速·指针定焦（2–3费）
- 聚焦现在｜Skill 3（消耗）
  - 指针跃迁到所选敌人；对其立刻结算PD×2。

- 视线牵引｜Attack 2
  - 指针跃迁到所选敌人；造成8点伤害；若原始距离≥2，改为12点。

- 枢轴定位｜Skill 3
  - 指针跃迁到所选敌人；本回合指针固定于该单位（不随牌移动），回合结束解除。

- 瞬移→位移｜Skill 2
  - 指针跃迁到所选敌人；随后将该单位按指针方向移动1。

---

#### E. 本轮选用（精简：乱动 + 定焦）
- 乱动·洗场爆裂｜Skill 2
  - 反转队列；对所有敌人施加【规整】+1；随后对每个敌人造成3点伤害（逐段）。

- 视线牵引（定焦）｜Attack 2
  - 指针跃迁到所选敌人；造成8点伤害；若原始距离≥2，改为12点。